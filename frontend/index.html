<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="XILFTEN - Media multi-use scheduling application">
    <title>XILFTEN - Media Scheduler</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/carousel.css">
    <link rel="stylesheet" href="/static/css/calendar.css">
    <link rel="stylesheet" href="/static/css/components.css">

    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <!-- Main Application Container -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1 class="app-title">XILFTEN</h1>
                <p class="app-subtitle">Media Scheduling & Discovery</p>
                <nav class="main-nav">
                    <button class="nav-button active" data-view="carousel">Browse</button>
                    <button class="nav-button" data-view="recommendations">Recommendations</button>
                    <button class="nav-button" data-view="ai">AI Assistant</button>
                    <button class="nav-button" data-view="criteria-3d">3D Space</button>
                </nav>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="app-main">
            <!-- Calendar Sidebar -->
            <aside id="calendar-sidebar" class="calendar-sidebar">
                <!-- Month Calendar Grid -->
                <div class="calendar-month-container">
                    <div class="calendar-month-header">
                        <span id="calendar-month-year" class="calendar-month-year">November 2025</span>
                    </div>
                    <div id="calendar-month-grid" class="calendar-month-grid">
                        <!-- Month grid will be rendered here by D3.js -->
                    </div>
                </div>

                <!-- Single Day Card -->
                <div class="day-detail-container">
                    <div id="day-detail-card" class="day-detail-card">
                        <!-- Day details will be rendered here by D3.js -->
                    </div>
                </div>
            </aside>

            <!-- Main Content Container -->
            <div class="main-content-wrapper">
            <!-- Carousel View -->
            <section id="carousel-view" class="view-section active">
                <div class="section-header">
                    <h2>Browse Media</h2>
                    <div class="view-controls">
                        <select id="filter-genre" class="filter-select">
                            <option value="">All Genres</option>
                            <option value="sci-fi">Science Fiction</option>
                            <option value="action">Action</option>
                            <option value="film-noir">Film Noir</option>
                            <option value="documentary">Documentary</option>
                            <option value="comedy">Comedy</option>
                            <option value="anime">Anime</option>
                        </select>
                        <input type="search" id="search-media" class="search-input" placeholder="Search media...">
                    </div>
                </div>
                <div id="media-carousel" class="carousel-container">
                    <div class="carousel-count-badge">
                        <span id="carousel-count">0</span> movies
                    </div>
                    <!-- D3.js carousel will be rendered here -->
                    <p class="loading-message">Loading media...</p>
                </div>
            </section>

            <!-- Recommendations View -->
            <section id="recommendations-view" class="view-section">
                <div class="section-header">
                    <h2>Recommendations</h2>
                    <div class="view-controls">
                        <select id="criteria-preset" class="filter-select">
                            <option value="">Select Criteria Preset...</option>
                            <option value="high-quality-scifi">High Quality Sci-Fi</option>
                            <option value="friday-action">Friday Night Action</option>
                        </select>
                        <button id="create-criteria" class="primary-button">Create Custom Criteria</button>
                    </div>
                </div>
                <div id="recommendations-container" class="recommendations-container">
                    <!-- Recommendations will be rendered here -->
                    <p class="empty-message">Select a criteria preset or create your own to get recommendations.</p>
                </div>
            </section>

            <!-- AI Assistant View -->
            <section id="ai-view" class="view-section">
                <div class="section-header">
                    <h2>AI Assistant</h2>
                    <p class="section-description">Create mashups and get creative recommendations</p>
                </div>

                <!-- Persona Selector -->
                <div class="persona-selector-container">
                    <div class="persona-selector">
                        <label for="persona-select">Critic Persona:</label>
                        <select id="persona-select" class="persona-select">
                            <option value="">No Persona (Default AI)</option>
                            <!-- Personas will be loaded dynamically -->
                        </select>
                        <button id="clear-cache-btn" class="secondary-button">Clear Cache</button>
                    </div>
                    <div id="cache-metrics" class="cache-metrics">
                        <span class="cache-label">CAG Cache:</span>
                        <span id="cache-usage" class="cache-usage">0 MB / 10 MB</span>
                        <div class="cache-bar">
                            <div id="cache-bar-fill" class="cache-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div id="ai-chat-container" class="chat-container">
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-message assistant">
                            <p>Hello! I can help you:</p>
                            <ul>
                                <li>Find movies that combine different genres and styles</li>
                                <li>Generate high-concept summaries for new ideas</li>
                                <li>Discover hidden gems in your favorite categories</li>
                            </ul>
                            <p>Try asking: "Suggest a movie with fantasy action like World of Warcraft but serious drama like Chernobyl"</p>
                            <p><strong>New!</strong> Select a critic persona above to get reviews in their style.</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <textarea id="chat-input" class="chat-input" placeholder="Ask me anything about media..." rows="3"></textarea>
                        <button id="send-message" class="primary-button">Send</button>
                    </div>
                    <div class="preset-queries">
                        <button class="preset-button" data-query="fantasy action + serious drama">Fantasy + Drama</button>
                        <button class="preset-button" data-query="witty dialogue + action + plot-driven">Dialogue + Action + Plot</button>
                        <button class="preset-button" data-query="underrated Iranian films 1970s">Iranian Cinema 1970s</button>
                    </div>
                </div>
            </section>

            <!-- 3D Criteria Visualization View -->
            <section id="criteria-3d-view" class="view-section">
                <div class="section-header">
                    <h2>3D Movie Space</h2>
                    <p class="section-description">Movies visualized by Storytelling, Characters, and Vision</p>
                </div>
                <div id="criteria-3d-viz" class="criteria-3d-container">
                    <!-- 3D visualization will be rendered here -->
                </div>
                <div class="criteria-3d-instructions">
                    <p><strong>Controls:</strong> Click and drag to rotate the space</p>
                    <p><strong>Axes:</strong> <span style="color: #ef4444;">Red = Storytelling</span> | <span style="color: #10b981;">Green = Characters</span> | <span style="color: #3b82f6;">Blue = Vision</span></p>
                </div>
            </section>
            </div><!-- End main-content-wrapper -->

            <!-- Movie Info Sidebar -->
            <aside id="movie-info-sidebar" class="movie-info-sidebar" style="display: none;">
                <button class="sidebar-close" aria-label="Close">&times;</button>
                <div id="movie-info-content" class="movie-info-content">
                    <!-- Content will be populated dynamically -->
                </div>
            </aside>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>&copy; 2025 XILFTEN - Media Scheduling & Discovery</p>
            <p class="footer-note">Running on port 7575 | Powered by Ollama & TMDB</p>
        </footer>
    </div>

    <!-- JavaScript Modules -->
    <script type="module" src="/static/js/main.js"></script>
    <script type="module" src="/static/js/api-client.js"></script>
    <script type="module" src="/static/js/carousel.js"></script>
    <script type="module" src="/static/js/calendar.js"></script>
    <script type="module" src="/static/js/recommendations.js"></script>
    <script type="module" src="/static/js/criteria-builder.js"></script>
    <script type="module" src="/static/js/ai-interface.js"></script>
    <script type="module" src="/static/js/3d-criteria-viz.js"></script>
    <script type="module" src="/static/js/persona-manager.js"></script>
    <script type="module" src="/static/js/expanded-card.js"></script>
</body>
</html>
